<?phpclass Postmeeting_model extends CI_Model{	function __construct()	{		parent::__construct();		$this->load->database();		$this->config->load('dbtables', TRUE);			}		function getPostMeetings()	{		$postMeetingsQuery = $this->db->get_where($this->config->item('ala_post_meeting','dbtables'), array("user_id"=>trim($this->session->userdata("user_id"))));		return $postMeetingsQuery->result();	}		function getPostMeetingsCount()	{		$this->db->where('user_id', trim($this->session->userdata("user_id")));		return $this->db->count_all_results($this->config->item('ala_post_meeting','dbtables'));	}			function getActionsWithoutPostMeetings()	{		$this->db->select('aa.*, apmam.id as mapping_id');		$this->db->join($this->config->item('ala_post_meeting_action_mapping','dbtables').' apmam','apmam.action_id=aa.id','left');		$this->db->where('aa.user_id', trim($this->session->userdata("user_id")));		$this->db->where('apmam.id IS NULL');		$actionsWithoutPostMeetingsQuery = $this->db->get($this->config->item('ala_actions','dbtables').' aa');		return $actionsWithoutPostMeetingsQuery->result();	}		function insertPostMeeting()	{		$checkPostMeeting = $this->db->get_where($this->config->item('ala_post_meeting','dbtables'),array("general_topic"=>trim($this->input->post("general_topic")), "user_id"=>trim($this->session->userdata("user_id"))));		if($checkPostMeeting->row())		{			return "exist";		}		else		{			$insertArr = array(								'user_id' => trim($this->session->userdata("user_id")),								'general_topic' => trim($this->input->post("general_topic")),								'session_value' => trim($this->input->post("session_value")),								'notes' => trim($this->input->post("notes")),								'created_at' => date("Y-m-d H:i:s"),								'updated_at' => date("Y-m-d H:i:s"),							  );			$result = $this->db->insert($this->config->item('ala_post_meeting','dbtables'), $insertArr);			$postMeetingId =  $this->db->insert_id();			return $postMeetingId;		}	}		function getPostMeetingData($postMeetingId)	{		$getPostMeetingQuery = $this->db->get_where($this->config->item('ala_post_meeting','dbtables'),array("id"=>trim($postMeetingId)));		$postMeetingData = $getPostMeetingQuery->row();		$postMeetingData->actions = array();		if($postMeetingData)		{			$this->db->select('apmam.is_finished,aa.*,aat.title as action_type_title');			$this->db->where('id', trim($postMeetingId));			$this->db->join($this->config->item('ala_actions','dbtables').' aa', 'aa.id=apmam.action_id');			$this->db->join($this->config->item('ala_action_types','dbtables').' aat', 'aat.id=aa.action_type_id');			$getActionsQuery = $this->db->get($this->config->item('ala_post_meeting_action_mapping','dbtables').' apmam');			$postMeetingData->actions = $getActionsQuery->result();		}		return $postMeetingData;	}	function updatePostMeeting($postMeetingId)	{		$checkPostMeetingQuery = $this->db->get_where($this->config->item('ala_post_meeting','dbtables'),array("general_topic"=>trim($this->input->post("general_topic")), "user_id"=>trim($this->session->userdata("user_id"))));		$checkPostMeeting = $checkPostMeetingQuery->row();				if($checkPostMeeting && $checkPostMeeting->id!=$postMeetingId)		{			return "exist";		}		else		{			$data = array(							'general_topic' => trim($this->input->post("general_topic")),							'session_value' => trim($this->input->post("session_value")),							'notes' => trim($this->input->post("notes")),							'updated_at' => date("Y-m-d H:i:s"),						);			$this->db->where('id',$postMeetingId);			$res = $this->db->update($this->config->item('ala_post_meeting','dbtables'), $data);			return $res;		}	}		function deletePostMeeting($postMeetingId)	{		$this->db->where('id', $postMeetingId);		$res = $this->db->delete($this->config->item('ala_post_meeting','dbtables'));		return $res;	}	}?>